<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= product.SHname %> - harishMobile</title>
    <script
      src="https://kit.fontawesome.com/3a523928fc.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="/css/storeHeader.css" />
    <link rel="stylesheet" href="/css/detailPage.css" />
  </head>
  <body>
    <%- include(`../partials/storeHeader`) %>
    <%- include(`../partials/fonts`) %>
    <%- include(`../partials/cartAddToast`) %>
    <script src="/javascript/store.js"></script>

    <a class="back-btn" href="/"><i class="fa-solid fa-arrow-left"></i>  Back</a>

    <!-- Product detail slider -->
<div id="upwrapIS">
  <section id="imageSlider">
    <div class="carousel" id="carousel">
      <div class="carousel-track">
        <% if (product.productDetail && product.productDetail.images && product.productDetail.images.length) { %>
          <!-- First image -->
          <img id="slide" src="/uploads/<%= product.productDetail.images[0] %>" alt="Detail 1" />

          <!-- Video goes second if exists -->
          <% if (product.productDetail.video) { %>
            <video id="slide" src="/uploads/<%= product.productDetail.video %>" controls></video>
          <% } %>

          <!-- Remaining images -->
          <% product.productDetail.images.slice(1).forEach(function(img, idx) { %>
            <img id="slide" src="/uploads/<%= img %>" alt="Detail <%= idx+2 %>" />
          <% }); %>
        <% } %>
      </div>
      <div class="carousel-dots" id="dots"></div>
    </div>
  </section>
</div>

<!-- Product title + category -->
<div class="pd-head">
  <% const categoryLabel = { SH: 'Refurbished', N: 'New' }[product.category]; %>
  <h1 class="pd-title">
    <%= product.name %><%= categoryLabel ? ' - ' + categoryLabel : '' %>
  </h1>
</div>



<!-- Condition + Specs -->
<% 
  const _s = v => (v == null ? '' : String(v).trim());
  const ramV = _s(product.specs?.memory?.ram);
  const stoV = _s(product.specs?.memory?.storage);
  const colV = _s(product.specs?.design?.color);
  const addGB = v => v ? (/\d/.test(v) && !/gb/i.test(v) ? `${v}GB` : v) : '';
  const ram = addGB(ramV);
  const storage = addGB(stoV);
%>

<div class="pd-specs">
  <% if (product.condition) { %>
    <div class="spec-row">
      <span class="spec-label">Condition :</span>
      <span class="spec-value"><%= product.condition %></span>
    </div>
  <% } %>

  <% if (ram) { %>
    <div class="spec-row">
      <span class="spec-label">RAM :</span>
      <span class="spec-value"><%= ram %></span>
    </div>
  <% } %>

  <% if (storage) { %>
    <div class="spec-row">
      <span class="spec-label">Storage :</span>
      <span class="spec-value"><%= storage %></span>
    </div>
  <% } %>

  <% if (colV) { %>
    <div class="spec-row">
      <span class="spec-label">Color :</span>
      <span class="spec-value"><%= colV %></span>
    </div>
  <% } %>
</div>

<!-- Price Section -->
<div class="pd-price">
  <div class="price-current">â‚¹<%= product.price %></div>
  
    <% if (product.mrp) { %>
    <div class="price-mrp"><s>â‚¹<%= product.mrp %></s></div>
      <% } %>
      <% if (product.discount) { %>
    <div class="price-discount"><%= product.discount %>% Off</div>
  <% } %>
  
  
</div>

    <!-- <div class="product-details">
  <img src="/uploads/<%= product.image %>" alt="<%= product.name %>" width="300" />
  <h1><%= product.name %></h1>

  <% if (product.condition) { %>
    <p>Condition: <%= product.condition %></p>
  <% } %>

  <p>MRP: â‚¹<%= product.mrp %></p>
  <p>Discount: <%= product.discount %>%</p>
  <p>Price: â‚¹<%= product.price %></p> -->

  <form action="/cart/add" method="POST">
    <input type="hidden" name="productId" value="<%= product.id %>" />
    <input type="hidden" name="qty" value="1" />
    <input type="hidden" name="buyNow" value="true" />  <!-- ðŸ‘ˆ Add this -->
    <button type="submit">Buy Now</button>
  </form>
</div>
  </body>
</html>
